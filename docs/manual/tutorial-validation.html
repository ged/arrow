<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

<!--

		Arrow Manual: Input Validation Tutorial
		$Id: tutorial-validation.html,v 1.5 2004/02/01 15:21:42 stillflame Exp $

		Author:		Michael Granger
		Time-stamp: <23-Apr-2001 19:58:12 deveiant>

  -->

  <head>
	<title>Arrow Manual: Input Validation Tutorial</title>

	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />

    <meta name="authors" content="Michael Granger (ged@FaerieMUD.org)>" />
	<link rel="stylesheet" href="manual.css" type="text/css" />
  </head>
  <body>


	<!--#include virtual="linkbox.incl" -->

	<div id="content">
	  <h1>Arrow: Input Validation Tutorial</h1>

	  <div class="section">
	    <p>Web applications generally take input through forms, whose data is
		  then converted into named values (as in a hash).  While it may
		  sometimes be okay to accept incoming data as is, the chance of
		  malevolent data, even from trusted networks, as well as the extent to
		  which such data can compromise a system (through the use of escape,
		  shell and other sequences), makes doing so in today's internet
		  suicidal.</p>

		<p>A first line of defense taken by ruby is to taint all incoming data,
		  alterting the programmer to the potential danger.  The programmer is
		  then expected to analyse this data before using it, and with ruby's
		  taint checking turned on, this step is enforced by preventing use of
		  the tainted data.  By default, ruby programs run under Apache should
		  have this option enabled.</p>

		<p>The analysis step is generally understood to mean using a regular
		  expression to scrape out the acceptable input from any possible data.
		  To enable this, we have tied in the FormValidator library and make
		  using it a part of every application.  It is not mandatory (you still
		  have access to the unaltered Apache request), but by default, using
		  something like this can ensure you catch things consistently.</p>

		<p>FormValidator is also useful for creating even stricter constraints,
		  giving an application plenty of control over what values are
		  acceptable for any given field, and further providing a convenient
		  interface to determining in what ways the form was improperly filled
		  out.</p>
	  </div>
	  <div class="section">
		<h2><a href="#writing" id="writing">Writing a Validation Specification</a></h2>
		<p>The documentation for <a href="http://grub.ath.cx/formvalidator/doc">
		  FormValidator </a> gives a thorough coverage of the different options
		  that are available to control how data gets through.  We give here a
		  brief coverage of some of these, with more of a mind on how this
		  package is integrated with the applications you will be writing.</p>

		<p>To begin with, recognize that any action which expects to receive
		  input must declare a specification for it to get through.  Further, a
		  specification must validate every field of the expected input, or
		  individual fields will not be passed in.  To simplify this, you may
		  end up writing a few base validation schemes that then get extended by
		  each of the actions.</p>

		<p>The specifications are kept in the signature of an application,
		  stored as a Hash keyed by action name, with values of that action's
		  specification.  While it is acceptable to include all of your actions'
		  specifications when the signature is first declared, you may find it
		  more readable to include an action's specification immediately before
		  or after the action itself, thus keeping related information
		  together.  (This is equally applicable to templates, config(?) and
		  monitors(?).)</p>
	  </div>
	  <div class="section">
		<h2><a href="#example" id="example">Application With Input - Args</a></h2>
<pre>
class Args < Arrow::Application

    Signature = {
        :name => "Argument Tester",
        :description => "This app is for testing/debugging the argument validator.",
        :uri => "args",
        :maintainer => "god@host.com",
        :defaultAction => 'display',
        :templates => {
            :display    => 'args-display.tmpl',
        },
        :vargs => {
            :display    => {
                :required       => :name,
                :optional       => [:email, :description],
                :filters        => [:strip, :squeeze],
                :constraints    => {
                    :email   => :email,
                    :name    => /^[\x20-\x7f]+$/,
                    :description => /^[\x20-\x7f]+$/,
                },
            },
        },
    }

end # class Args
</pre>

<pre>
template here?
</pre>
		<p></p>
	  </div>

	</div>

  </body>
</html>


<!--
  Local Variables:
  mode: xml
 -->

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

<!--

  New Wiki Setup

  -->

  <head>
	<title>New Wiki Setup</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<link rel="stylesheet" type="text/css" href="/stylesheets/arrow.css" />

	<script type="text/javascript"><!-- 
		function proposeAddress() {
		  document.getElementById('web_address').value =
			document.getElementById('web_name').value.replace(/[^a-zA-Z0-9]/g, "").toLowerCase();
		}

		function cleanAddress() {
		  document.getElementById('web_address').value =
			document.getElementById('web_address').value.replace(/[^a-zA-Z0-9]/g, "").toLowerCase();
		}

		function validateSetup() {
		  if (document.getElementById('web_name').value == "") {
			alert("You must pick a name for the first web");
			return false;
		  }

		  if (document.getElementById('web_address').value == "") {
			alert("You must pick an address for the first web");
			return false;
		  }

		  if (document.getElementById('password').value == "") {
			alert("You must pick a system password");
			return false;
		  }

		  if (document.getElementById('password_check').value == "" ||
			  document.getElementById('password').value != document.getElementById('password_check').value) {
			alert("The password and its verification doesn't match");
			return false;
		  }

		  return true;
		}
		// -->
	</script>
  </head>
  <body>

	<h1>New Wiki Setup</h1>

<?if errors?>
	<p>Sorry, there were errors in your submission:</p>
	<ul>
<?for err in errors ?>
		<li><?attr err?></li>
<?end for?>
	</ul>
<?else?>
	<p>
	  Congratulations on succesfully installing and starting Instiki. 
	  Since this is the first time Instiki has been run on this port, you'll need to do a brief one-time setup.
	</p>
<?end if?>

	<form action="[?call txn.action ?]/create_system" id="setup" method="post" onsubmit="return validateSetup()">
	  <ol class="setup">
		<li>

		  <h2 style="margin-bottom: 3px">Name and address for your first web</h2>

		  <div class="help">
			The name of the web is included in the title on all pages. The
			address is the base path that all pages within the web live
			beneath. Ex: the address "rails" gives URLs like
			<i>/show/rails/HomePage</i>. The address can only consist of letters
			&amp; digits.
		  </div>

		  <div class="inputBox">
			Name: <input type="text" id="web_name" name="web_name" value="Wiki" onchange="proposeAddress();" 
			onclick="this.value == 'Wiki' ? this.value = '' : true" /> &nbsp;&nbsp;
			Address: <input type="text" id="web_address" name="web_address" onchange="cleanAddress();" value="wiki" />
		  </div>
		</li>

		<li>
		  <h2 style="margin-bottom: 3px">Password for creating and changing webs</h2>
		  <div class="help">
			Administrative access allows you to make new webs and change existing ones.<br/>
			Everyone with this password will be able to do this, so pick it carefully.
		  </div>
		  <div class="inputBox">
			Password: <input type="password" id="password" name="password" /> &nbsp;&nbsp;
			Verify: <input type="password" id="password_check" name="password_check" />
		  </div>
		</li>
	  </ol>

	  <p align="right">
		<input type="submit" value="Setup" style="margin-left: 40px" />
	  </p>
	</form>


	<?include navbar.incl?>

  </body>
</html>


<!--
  Local Variables:
  mode: nxml
 -->

